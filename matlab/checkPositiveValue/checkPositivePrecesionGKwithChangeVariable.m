clc
clear all
close all

format shortE

k = 1; N = 4;
n = 0:N+1; m = 0:N;

a = [1 ...
     0.3126028287472988...
     0.0673008212829461...
     0.0087798043423074...
     0.0007222414330882...
     0.0000295873218273];
b = [1 ...
     0.0626028287472659...
     0.0238723363198067...
     0.0010727527758408...
     0.0000687107172921];

x = 0:0.1:50;
y = log(1 + exp(x));

x_minus = 0:-0.1:-50;
y_minus = log(1 + exp(x_minus));

I_approximate = [0.82246703342411320
0.89432340773506502
0.97142947016952785
1.05403366713302170
1.14238198615843570
1.23671678685334530
1.33727570151111160
1.44429062415627650
1.55798680337702570
1.67858205047288970
1.80628607044477430
1.94129991939799580
2.08381558821218600
2.23401570901132150
2.39207337815399160
2.55815208722278120
2.73240575184288080
2.91497882708643540
3.10600649767437260
3.30561493110438360
3.51392158213380320
3.73103553764661240
3.95705789175397980
4.19208214194339930
4.43619459813790670
4.68947479759976550
4.95199591966992530
5.22382519534297530
5.50502430761462150
5.79564977939114190
6.09575334650940710
6.40538231408078220
6.72457989494359240
7.05338552949212620
7.39183518655188540
7.73996164529856930
8.09779475848057470
8.46536169740968520
8.84268717934021350
9.22979367797033490
9.62670161787825230
10.03342955375480700
10.44999433532075300
10.87641125882350800
11.31269420600054700
11.75885577137737700
12.21490737874009200
12.68085938758833500
13.15672119033625800
13.64250130098787400
14.13820743597069400
14.64384658776860700
15.15942509195224600
15.68494868816345200
16.22042257557005500
16.76585146326833000
17.32123961607402400
17.88659089610756000
18.46190880054656700
19.04719649588816600
19.64245684903475800
20.24769245549056200
20.86290566493141800
21.48809860438767300
22.12327319925895000
22.76843119236028200
23.42357416118142800
24.08870353352445900
24.76382060167068700
25.44892653521332100
26.14402239268059300
26.84910913206204300
27.56418762034115100
28.28925864212687100
29.02432290746913100
29.76938105893478000
30.52443367801369300
31.28948129091805400
32.06452437383219200
32.84956335766470700
33.64459863234981900
34.44963055074093500
35.26465943213448600
36.08968556545944000
36.92470921216398900
37.76973060882799900
38.62474996952746400
39.48976748797428400
40.36478333945274200
41.24979768257181700
42.14481066085129900
43.04982240415673500
43.96483302999834600
44.88984264470612100
45.82485134449327500
46.76985921641880100
47.72486633925831300
48.68987278429188600
49.66487861601731900
50.64988389279535100
51.64488866743354800
52.64989298771467200
53.66489689687474400
54.68990043403562900
55.72490363459652900
56.76990653058820200
57.82490915099347000
58.88991152203713900
59.96491366744860600
61.04991560869914500
62.14491736521690500
63.24991895458122600
64.36492039269863600
65.48992169396197500
66.62492287139438900
67.76992393678001700
68.92492490078113600
70.08992577304599100
71.26492656230404100
72.44992727645465900
73.64492792264502400
74.84992850734239800
76.06492903639858100
77.28992951510858200
78.52492994826342000
79.76993034019818700
81.02493069483549000
82.28993101572467600
83.56493130607722700
84.84993156879903600
86.14493180651966500
87.44993202161830900
88.76493221624747300
90.08993239235525200
91.42493255170423100
92.76993269588923900
94.12493282635310300
95.48993294440180100
96.86493305121652500
98.24993314786661400
99.64493323531924300
101.04993331444967000
102.46493338604964000
103.88993345083620000
105.32493350945744000
106.76993356250004000
108.22493361049516000
109.68993365392286000
111.16493369321779000
112.64993372877339000
114.14493376094543000
115.64993379005583000
117.16493381639606000
118.68993384022960000
120.22493386179511000
121.76993388130855000
123.32493389896482000
124.88993391494090000
126.46493392939682000
128.04993394247705000
129.64493395431234000
131.24993396502151000
132.86493397471168000
134.48993398347960000
136.12493399141300000
137.76993399859148000
139.42493400508698000
141.08993401096438000
142.76493401628238000
144.44993402109438000
146.14493402544849000
147.84993402938818000
149.56493403295298000
151.28993403617835000
153.02493403909708000
154.76993404173794000
156.52493404412729000
158.28993404628952000
160.06493404824596000
161.84993405001623000
163.64493405161787000
165.44993405306735000
167.26493405437887000
169.08993405556552000
170.92493405663919000
172.76993405761084000
174.62493405848977000
176.48993405928519000
178.36493406000500000
180.24993406065613000
182.14493406124549000
184.04993406177854000
185.96493406226116000
187.88993406269762000
189.82493406309268000
191.76993406345011000
193.72493406377342000
195.68993406406622000
197.66493406433094000
199.64993406457080000
201.64493406478724000
203.64993406498360000
205.66493406516105000
207.68993406532158000
209.72493406546681000
211.76993406559865000
213.82493406571771000
215.88993406582529000
217.96493406592265000
220.04993406601088000
222.14493406609051000
224.24993406616264000
226.36493406622796000
228.48993406628705000
230.62493406634070000
232.76993406638914000
234.92493406643288000
237.08993406647252000
239.26493406650854000
241.44993406654106000
243.64493406657019000
245.84993406659675000
248.06493406662094000
250.28993406664273000
252.52493406666227000
254.76993406668001000
257.02493406669635000
259.28993406671083000
261.56493406672388000
263.84993406673601000
266.14493406674671000
268.44993406675678000
270.76493406676548000
273.08993406677359000
275.42493406678091000
277.76993406678804000
280.12493406679351000
282.48993406679887000
284.86493406680398000
287.24993406680835000
289.64493406681203000
292.04993406681587000
294.46493406681935000
296.88993406682170000
299.32493406682465000
301.76993406682703000
304.22493406682952000
306.68993406683131000
309.16493406683338000
311.64993406683499000
314.14493406683692000
316.64993406683806000
319.16493406683912000
321.68993406684029000
324.22493406684117000
326.76993406684238000
329.32493406684290000
331.88993406684381000
334.46493406684419000
337.04993406684520000
339.64493406684574000
342.24993406684615000
344.86493406684707000
347.48993406684718000
350.12493406684752000
352.76993406684812000
355.42493406684827000
358.08993406684857000
360.76493406684909000
363.44993406684915000
366.14493406684977000
368.84993406684958000
371.56493406684973000
374.28993406684992000
377.02493406685056000
379.76993406685057000
382.52493406685068000
385.28993406685078000
388.06493406685087000
390.84993406685101000
393.64493406685114000
396.44993406685126000
399.26493406685120000
402.08993406685170000
404.92493406685173000
407.76993406685165000
410.62493406685149000
413.48993406685190000
416.36493406685207000
419.24993406685212000
422.14493406685204000
425.04993406685236000
427.96493406685215000
430.88993406685233000
433.82493406685285000
436.76993406685284000
439.72493406685260000
442.68993406685257000
445.66493406685254000
448.64993406685295000
451.64493406685307000
454.64993406685289000
457.66493406685282000
460.68993406685291000
463.72493406685311000
466.76993406685290000
469.82493406685330000
472.88993406685313000
475.96493406685346000
479.04993406685338000
482.14493406685330000
485.24993406685337000
488.36493406685327000
491.48993406685338000
494.62493406685343000
497.76993406685364000
500.92493406685298000
504.08993406685323000
507.26493406685364000
510.44993406685353000
513.64493406685358000
516.84993406685351000
520.06493406685343000
523.28993406685379000
526.52493406685346000
529.76993406685324000
533.02493406685358000
536.28993406685311000
539.56493406685297000
542.84993406685271000
546.14493406685256000
549.44993406685251000
552.76493406685233000
556.08993406685170000
559.42493406685173000
562.76993406685153000
566.12493406685121000
569.48993406685076000
572.86493406685031000
576.24993406684996000
579.64493406684960000
583.04993406684878000
586.46493406684840000
589.88993406684790000
593.32493406684682000
596.76993406684608000
600.22493406684475000
603.68993406684422000
607.16493406684265000
610.64993406684130000
614.14493406683982000
617.64993406683845000
621.16493406683605000
624.68993406683444000
628.22493406683191000
631.76993406682948000
635.32493406682647000
638.88993406682391000
642.46493406681975000
646.04993406681581000
649.64493406681208000
653.24993406680755000
656.86493406680199000
660.48993406679665000
664.12493406679016000
667.76993406678343000
671.42493406677534000
675.08993406676734000
678.76493406675786000
682.44993406674735000
686.14493406673580000
689.84993406672345000
693.56493406670859000
697.28993406669338000
701.02493406667577000
704.76993406665679000
708.52493406663609000
712.28993406661186000
716.06493406658672000
719.84993406655803000
723.64493406652684000
727.44993406649201000
731.26493406645352000
735.08993406641048000
738.92493406636345000
742.76993406631198000
746.62493406625424000
750.48993406619047000
754.36493406612010000
758.24993406604278000
762.14493406595625000
766.04993406586186000
769.96493406575712000
773.88993406564089000
777.82493406551362000
781.76993406537179000
785.72493406521505000
789.68993406504228000
793.66493406485108000
797.64993406463998000
801.64493406440704000
805.64993406414828000
809.66493406386371000
813.68993406354832000
817.72493406319973000
821.76993406281565000
825.82493406238984000
829.88993406191958000
833.96493406139984000
838.04993406082576000
842.14493406019096000
846.24993405948931000
850.36493405871454000
854.48993405785779000
858.62493405691055000
862.76993405586461000
866.92493405470748000
871.08993405342960000
875.26493405201677000
879.44993405045614000
883.64493404873019000
887.84993404682371000
892.06493404471632000
896.28993404238747000
900.52493403981316000
904.76993403696918000
909.02493403382516000
913.28993403035020000
917.56493402651063000
921.84993402226610000
926.14493401757647000
930.44993401239299000
934.76493400666470000
939.08993400033341000
943.42493399333637000
947.76993398560342000
952.12493397705725000
956.48993396761227000
960.86493395717434000
965.24993394563808000
969.64493393288899000
974.04993391879816000
978.46493390322701000
982.88993388601716000
987.32493386699707000
991.76993384597699000
996.22493382274627000
1000.68993379707240000
1005.16493376869780000
1009.64993373734000000
1014.14493370268300000
1018.64993366438240000
1023.16493362205270000
1027.68993357527120000
1032.22493352356990000
1036.76993346643140000
1041.32493340328300000
1045.88993333349340000
1050.46493325636400000
1055.04993317112390000
1059.64493307691740000
1064.24993297280390000
1068.86493285774050000
1073.48993273057520000
1078.12493259003650000
1082.76993243471720000
1087.42493226306240000
1092.08993207335490000
1096.76493186369520000
1101.44993163198640000
1106.14493137590780000
1110.84993109289690000
1115.56493078012200000
1120.28993043445190000
1125.02493005242760000
1129.76992963022550000
1134.52492916362010000
1139.28992864794100000
1144.06492807802760000
1148.84992744817580000
1153.64492675208180000
1158.44992598277960000
1163.26492513256880000
1168.08992419294030000
1172.92492315449090000
1177.76992200682590000
1182.62492073846080000
1187.48991933670030000
1192.36491778751470000
1197.24991607540100000
1202.14491418322110000
1207.04991209204060000
1211.96490978092810000
1216.88990722675450000
1221.82490440395440000
1226.76990128428000000
1231.72489783650620000
1236.68989402612670000
1241.66488981500670000
1246.64988516099970000
1251.64488001752560000];

I_approximate = [0.82246703342411309
0.89432340773506491
0.97142947016952774
1.05403366713302170
1.14238198615843570
1.23671678685334530
1.33727570151111140
1.44429062415627610
1.55798680337702590
1.67858205047288970
1.80628607044477450
1.94129991939799520
2.08381558821218650
2.23401570901132240
2.39207337815399200
2.55815208722278080
2.73240575184288210
2.91497882708643500
3.10600649767437260
3.30561493110438500
3.51392158213380280
3.73103553764661330
3.95705789175397890
4.19208214194340200
4.43619459813790850
4.68947479759976460
4.95199591966992530
5.22382519534297440
5.50502430761462240
5.79564977939114190
6.09575334650940630
6.40538231408078480
6.72457989494359420
7.05338552949212440
7.39183518655188540
7.73996164529856930
8.09779475848057470
8.46536169740968880
8.84268717934020820
9.22979367797034020
9.62670161787825050
10.03342955375480400
10.44999433532075300
10.87641125882350900
11.31269420600054300
11.75885577137737800
12.21490737874009200
12.68085938758833500
13.15672119033626000
13.64250130098787700
14.13820743597069000
14.64384658776861200
15.15942509195224200
15.68494868816345700
16.22042257557004800
16.76585146326831900
17.32123961607402800
17.88659089610757000
18.46190880054656000
19.04719649588816200
19.64245684903475800
20.24769245549055100
20.86290566493141800
21.48809860438767300
22.12327319925893200
22.76843119236029600
23.42357416118140600
24.08870353352445500
24.76382060167067300
25.44892653521333900
26.14402239268057900
26.84910913206204300
27.56418762034115100
28.28925864212688200
29.02432290746914500
29.76938105893478000
30.52443367801369300
31.28948129091805800
32.06452437383220700
32.84956335766469200
33.64459863234985400
34.44963055074092000
35.26465943213450100
36.08968556545942600
36.92470921216399700
37.76973060882800600
38.62474996952747100
39.48976748797429100
40.36478333945274200
41.24979768257182400
42.14481066085127700
43.04982240415672800
43.96483302999834600
44.88984264470612800
45.82485134449324700
46.76985921641883000
47.72486633925834100
48.68987278429185700
49.66487861601731900
50.64988389279533700
51.64488866743354100
52.64989298771465800
53.66489689687473700
54.68990043403562100
55.72490363459651500
56.76990653058820200
57.82490915099346300
58.88991152203714600
59.96491366744860600
61.04991560869915200
62.14491736521692600
63.24991895458124000
64.36492039269866400
65.48992169396191800
66.62492287139444600
67.76992393677998900
68.92492490078126400
70.08992577304592000
71.26492656230405500
72.44992727645460200
73.64492792264498200
74.84992850734235500
76.06492903639859500
77.28992951510858200
78.52492994826339200
79.76993034019818700
81.02493069483547600
82.28993101572466200
83.56493130607719900
84.84993156879913600
86.14493180651967900
87.44993202161829500
88.76493221624745900
90.08993239235532300
91.42493255170423100
92.76993269588921000
94.12493282635313100
95.48993294440168700
96.86493305121652500
98.24993314786662800
99.64493323531921500
101.04993331444963000
102.46493338604967000
103.88993345083624000
105.32493350945740000
106.76993356250010000
108.22493361049507000
109.68993365392279000
111.16493369321779000
112.64993372877339000
114.14493376094536000
115.64993379005575000
117.16493381639594000
118.68993384022963000
120.22493386179515000
121.76993388130848000
123.32493389896493000
124.88993391494103000
126.46493392939684000
128.04993394247708000
129.64493395431242000
131.24993396502140000
132.86493397471168000
134.48993398347940000
136.12493399141300000
137.76993399859174000
139.42493400508707000
141.08993401096441000
142.76493401628244000
144.44993402109435000
146.14493402544832000
147.84993402938804000
149.56493403295286000
151.28993403617838000
153.02493403909693000
154.76993404173788000
156.52493404412738000
158.28993404628960000
160.06493404824596000
161.84993405001620000
163.64493405161804000
165.44993405306724000
167.26493405437873000
169.08993405556541000
170.92493405663905000
172.76993405761064000
174.62493405848960000
176.48993405928516000
178.36493406000494000
180.24993406065607000
182.14493406124549000
184.04993406177854000
185.96493406226108000
187.88993406269779000
189.82493406309274000
191.76993406345017000
193.72493406377362000
195.68993406406602000
197.66493406433085000
199.64993406457040000
201.64493406478738000
203.64993406498374000
205.66493406516102000
207.68993406532167000
209.72493406546701000
211.76993406559848000
213.82493406571757000
215.88993406582532000
217.96493406592259000
220.04993406601076000
222.14493406609060000
224.24993406616269000
226.36493406622807000
228.48993406628719000
230.62493406634064000
232.76993406638911000
234.92493406643291000
237.08993406647244000
239.26493406650837000
241.44993406654066000
243.64493406657016000
245.84993406659672000
248.06493406662091000
250.28993406664273000
252.52493406666230000
254.76993406668009000
257.02493406669629000
259.28993406671077000
261.56493406672428000
263.84993406673613000
266.14493406674688000
268.44993406675667000
270.76493406676576000
273.08993406677354000
275.42493406678091000
277.76993406678764000
280.12493406679334000
282.48993406679875000
284.86493406680387000
287.24993406680824000
289.64493406681214000
292.04993406681609000
294.46493406681890000
296.88993406682221000
299.32493406682482000
301.76993406682732000
304.22493406682929000
306.68993406683143000
309.16493406683338000
311.64993406683510000
314.14493406683624000
316.64993406683777000
319.16493406683895000
321.68993406684035000
324.22493406684134000
326.76993406684215000
329.32493406684290000
331.88993406684409000
334.46493406684414000
337.04993406684548000
339.64493406684579000
342.24993406684632000
344.86493406684690000
347.48993406684741000
350.12493406684769000
352.76993406684790000
355.42493406684821000
358.08993406684897000
360.76493406684915000
363.44993406684932000
366.14493406684960000
368.84993406684958000
371.56493406685007000
374.28993406685015000
377.02493406685011000
379.76993406685079000
382.52493406685056000
385.28993406685083000
388.06493406685092000
390.84993406685146000
393.64493406685102000
396.44993406685109000
399.26493406685171000
402.08993406685136000
404.92493406685196000
407.76993406685199000
410.62493406685178000
413.48993406685173000
416.36493406685202000
419.24993406685235000
422.14493406685216000
425.04993406685230000
427.96493406685232000
430.88993406685262000
433.82493406685256000
436.76993406685273000
439.72493406685254000
442.68993406685263000
445.66493406685277000
448.64993406685335000
451.64493406685307000
454.64993406685318000
457.66493406685328000
460.68993406685303000
463.72493406685311000
466.76993406685318000
469.82493406685353000
472.88993406685364000
475.96493406685369000
479.04993406685361000
482.14493406685364000
485.24993406685388000
488.36493406685378000
491.48993406685395000
494.62493406685383000
497.76993406685420000
500.92493406685423000
504.08993406685403000
507.26493406685421000
510.44993406685415000
513.64493406685426000
516.84993406685464000
520.06493406685456000
523.28993406685481000
526.52493406685460000
529.76993406685483000
533.02493406685460000
536.28993406685436000
539.56493406685502000
542.84993406685510000
546.14493406685517000
549.44993406685501000
552.76493406685540000
556.08993406685545000
559.42493406685526000
562.76993406685540000
566.12493406685542000
569.48993406685531000
572.86493406685611000
576.24993406685553000
579.64493406685563000
583.04993406685594000
586.46493406685636000
589.88993406685574000
593.32493406685614000
596.76993406685608000
600.22493406685624000
603.68993406685649000
607.16493406685629000
610.64993406685664000
614.14493406685619000
617.64993406685699000
621.16493406685674000
624.68993406685672000
628.22493406685680000
631.76993406685676000
635.32493406685728000
638.88993406685699000
642.46493406685693000
646.04993406685685000
649.64493406685756000
653.24993406685667000
656.86493406685724000
660.48993406685736000
664.12493406685735000
667.76993406685722000
671.42493406685742000
675.08993406685738000
678.76493406685756000
682.44993406685819000
686.14493406685813000
689.84993406685794000
693.56493406685809000
697.28993406685845000
701.02493406685835000
704.76993406685813000
708.52493406685812000
712.28993406685834000
716.06493406685877000
719.84993406685874000
723.64493406685847000
727.44993406685887000
731.26493406685881000
735.08993406685863000
738.92493406685924000
742.76993406685926000
746.62493406685962000
750.48993406685940000
754.36493406685929000
758.24993406685940000
762.14493406685961000
766.04993406685992000
769.96493406685988000
773.88993406686006000
777.82493406685990000
781.76993406686006000
785.72493406685976000
789.68993406686002000
793.66493406686027000
797.64993406686051000
801.64493406686074000
805.64993406686096000
809.66493406686027000
813.68993406686081000
817.72493406686101000
821.76993406686097000
825.82493406686103000
829.88993406686109000
833.96493406686136000
838.04993406686083000
842.14493406686154000
846.24993406686110000
850.36493406686145000
854.48993406686157000
858.62493406686190000
862.76993406686177000
866.92493406686174000
871.08993406686204000
875.26493406686188000
879.44993406686251000
883.64493406686211000
887.84993406686294000
892.06493406686218000
896.28993406686254000
900.52493406686244000
904.76993406686267000
909.02493406686267000
913.28993406686288000
917.56493406686297000
921.84993406686249000
926.14493406686324000
930.44993406686308000
934.76493406686382000
939.08993406686420000
943.42493406686344000
947.76993406686358000
952.12493406686394000
956.48993406686407000
960.86493406686373000
965.24993406686372000
969.64493406686393000
974.04993406686367000
978.46493406686432000
982.88993406686427000
987.32493406686388000
991.76993406686495000
996.22493406686431000
1000.68993406686470000
1005.16493406686500000
1009.64993406686480000
1014.14493406686520000
1018.64993406686510000
1023.16493406686490000
1027.68993406686510000
1032.22493406686540000
1036.76993406686530000
1041.32493406686630000
1045.88993406686590000
1050.46493406686550000
1055.04993406686570000
1059.64493406686620000
1064.24993406686640000
1068.86493406686600000
1073.48993406686690000
1078.12493406686620000
1082.76993406686620000
1087.42493406686640000
1092.08993406686640000
1096.76493406686680000
1101.44993406686690000
1106.14493406686730000
1110.84993406686820000
1115.56493406686670000
1120.28993406686750000
1125.02493406686790000
1129.76993406686710000
1134.52493406686770000
1139.28993406686800000
1144.06493406686760000
1148.84993406686820000
1153.64493406686820000
1158.44993406686810000
1163.26493406686860000
1168.08993406686910000
1172.92493406686840000
1177.76993406686940000
1182.62493406686940000
1187.48993406686900000
1192.36493406686940000
1197.24993406686920000
1202.14493406686960000
1207.04993406686980000
1211.96493406686950000
1216.88993406687000000
1221.82493406687010000
1226.76993406686980000
1231.72493406686980000
1236.68993406687040000
1241.66493406687050000
1246.64993406687020000
1251.64493406687030000];



for i = 1:length(y)
    I_precesion_minus(i) = gamma(k+1)*y_minus(i).*(sum(a.*(y_minus(i).^n))/sum(b.*(y_minus(i).^m))).^k;
    I_precesion(i) = x(i)^2/2 + 2*I_precesion_minus(1) - I_precesion_minus(i);
    
    % Для страховки добавим 10^-17
    delta(i) = log10(abs(I_approximate(i)/I_precesion(i)-1) + 10^-17);
end

disp('delta = ');
disp((delta)');
grid on, hold on
plot(x, delta, '*')