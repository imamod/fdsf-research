% % % (Fk)1lm(x) = exp(x)*[Г(k + 1) + exp(x)*R1klm(exp(x))], -inf <x <= l;
% % % (Fk)2lm(x) = R2klm(x), 1 <= x <= 4; 
% % % (Fk)3lm(x) = x^(k+1)*(1/(k+1) + 1/(x*x)*R3klm(1/x*x)], 4 <= x < inf;
clc
clear all
close all
format long e
x1 = 1; x2 = 4; n = 4;
% ---------------------------------------------------------
% | k = -1/2
% ---------------------------------------------------------

%%% КОэффициенты из статьи Cody, Thatcher, берем по максимуму n = 4
% Отрезок -inf <x <= l

p1_k_minus_half = [-1.253314128820...
                   -1.723663557701...
                   -0.6559045729258...
                   -0.06342283197682...
                   -0.00001488383106116];
q1_k_minus_half = [1 ... 
                   2.191780925980...
                   1.605812955406...
                   0.4443669527481...
                   0.03624232288112];
% Отрезок 1 <= x <= 4;
p2_k_minus_half = [1.0738127694... 
                   5.6003303660...
                   3.6882211270...
                   1.1743392816...
                   0.23641935527];
q2_k_minus_half = [1 ...
                   4.6031840667...
                   0.43075910674...
                   0.42151132145...
                   0.011832601601];
% Отрезок 4 <= x < inf
p3_k_minus_half = [-0.8222559330...
                   -36.20369345...
                   -3015.385410...
                   -70498.71579...
                   -56981.45924];
q3_k_minus_half = [1 ...
                   39.35689841...
                   3568.756266...
                   41818.93625...
                   338513.8907];

k = -1/2; 

R1_05 = R1(p1_k_minus_half, q1_k_minus_half, x1, n);
R2_05 = R2(p2_k_minus_half, q2_k_minus_half, x1, n);

F_05_first = exp(x1)*(gamma(k+1) + exp(x1)*R1_05);
F_05_second = R2_05;
disp('k = -1/2, X = 1')
disp('First interval: '); disp(F_05_first);
disp('Second interval: '); disp(F_05_second);

disp('Relation:'); disp(F_05_second/F_05_first - 1)
relative = F_05_second/F_05_first - 1;

R2_05 = R2(p2_k_minus_half, q2_k_minus_half, x2, n);
R3_05 = R3(p3_k_minus_half, q3_k_minus_half, x2, n);

F_05_second = R2_05;
F_05_third = (x2^(k+1))*(1/(k+1) + 1/(x2*x2)*R3_05);
disp('k = -1/2, X = 4')
disp('Second interval: '); disp(F_05_second);
disp('Third interval: '); disp(F_05_third); 

disp('Relation:'); disp(F_05_third/F_05_second - 1)
relative = [relative, F_05_third/F_05_second - 1];
% ----------------------------------------------------------

% ---------------------------------------------------------
% | k = 1/2
% ---------------------------------------------------------

%%% КОэффициенты из статьи Cody, Thatcher, берем по максимуму n = 4
% Отрезок -inf <x <= l
p1_k_half = [ -0.3133285305570...
              -0.4161873852293...
              -0.1502208400588...
              -0.01339579375173...
              -0.00001513350700138];
q1_k_half = [ 1 ...
              1.872608675902...
              1.145204446578...
              0.2570225587573...
              0.01639902543568];
% Отрезок 1 <= x <= 4;
p2_k_half = [0.678176626660... 
             0.633124017910...
             0.294479651772...
             0.0801320711419...
             0.0133918212940];
q2_k_half = [1 ...
             0.143740400397...
             0.0708662148450...
             0.00234579494735...
            -0.0000129449928835];
% Отрезок 4 <= x < inf
p3_k_half = [0.82244997626...
             20.046303393...
             1826.8093446...
             12226.530374...
             140407.50092];
q3_k_half = [1 ...
             23.486207659...
             2201.3483743...
             11442.673596...
             165847.15900];

k = 1/2;

R105 = R1(p1_k_half, q1_k_half, x1, n);
R205 = R2(p2_k_half, q2_k_half, x1, n);

F05_first = exp(x1)*(gamma(k+1) + exp(x1)*R105);
F05_second = R205;
disp('k = 1/2, X = 1')
disp('First interval: '); disp(F05_first);
disp('Second interval: '); disp(F05_second);

disp('Relation:'); disp(F05_second/F05_first - 1)
relative = [relative, F05_second/F05_first - 1];

R205_ = R2(p2_k_half, q2_k_half, x2, n);
R305 = R3(p3_k_half, q3_k_half, x2, n);

F05_second = R205_;
F05_third = (x2^(k+1))*(1/(k+1) + R305/(x2*x2));
disp('k = 1/2, X = 4')
disp('Second interval: '); disp(F05_second);
disp('Third interval: '); disp(F05_third);

disp('Relation:'); disp(F05_third/F05_second - 1)
relative = [relative, F05_third/F05_second - 1];
% ----------------------------------------------------------

% ---------------------------------------------------------
% | k = 3/2
% ---------------------------------------------------------

%%% КОэффициенты из статьи Cody, Thatcher, берем по максимуму n = 4
% Отрезок -inf <x <= l
p1_k_three_two_time = [-0.2349963985406...
                       -0.2927373637547...
                       -0.09883097588738...
                       -0.008251386379551...
                       -0.00001874384153223];
q1_k_three_two_time = [1.050000000000...
                       1.608597109146...
                       0.8275289530880...
                       0.1522322382850...
                       0.007695120475064];
% Отрезок 1 <= x <= 4;
p2_k_three_two_time = [1.1530213402... 
                       1.0591558972...
                       0.46898803095...
                       0.11882908784...
                       0.019438755787];
q2_k_three_two_time = [1 ...
                       0.037348953841...
                       0.023248458137...
                      -0.0013766770874...
                       0.000046466392781];
% Отрезок 4 <= x < inf
p3_k_three_two_time = [2.46740023684...
                       219.167582368...
                       12382.9379075...
                       120667.724968...
                       849442.920034];
q3_k_three_two_time = [1 ...
                       89.1125140619...
                       5045.75669667...
                       90907.5946304...
                       389960.915641];

k = 3/2;

R1_32 = R1(p1_k_three_two_time, q1_k_three_two_time, x1, n);
R2_32 = R2(p2_k_three_two_time, q2_k_three_two_time, x1, n);

F_32_first = exp(x1)*(gamma(k+1) + exp(x1)*R1_32);
F_32_second = R2_32;
disp('k = 3/2, X = 1')
disp('First interval: '); disp(F_32_first);
disp('Second interval: '); disp(F_32_second);

disp('Relation:'); disp(F_32_second/F_32_first - 1)
relative = [relative, F_32_second/F_32_first - 1];

R2_32 = R2(p2_k_three_two_time, q2_k_three_two_time, x2, n);
R3_32 = R3(p3_k_three_two_time, q3_k_three_two_time, x2, n);

F_32_second = R2_32;
F_32_third = (x2^(k+1))*(1/(k+1) + R3_32/(x2*x2));
disp('k = 3/2, X = 4')
disp('Second interval: '); disp(F_32_second);
disp('Third interval: '); disp(F_32_third);

disp('Relation:'); disp(F_32_third/F_32_second - 1)
relative = [relative, F_32_third/F_32_second - 1];

disp(log10(abs(relative)))
% ----------------------------------------------------------