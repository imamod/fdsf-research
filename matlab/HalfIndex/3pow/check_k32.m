%% Проверка глобальной аппроксимации из статьи
clc
clear all
close all

format long

k = 3/2;

x = -10:50;
y = log(1 + exp(x));

a1 = 0.7:0.01:1;
I_precesion = [6.0351475898064248e-05
0.00016405005803954575
0.00044591757785330605
0.0012120061844409513
0.0032936628101454617
0.0089463822604122466
0.024269405334868585
0.065611738806375441
0.17580098885401291
0.46084880629010166
1.1528038370883613
2.6616826247320038
5.5372536750083441
10.35371486476145
17.627702501044965
27.802446215748379
41.261002639226035
58.34221704166923
79.352593630331853
104.57424118772582
134.27015996313986
168.68786334441967
208.06195868207072
252.61605944682725
302.56425117568574
358.11224770852652
419.45832454206374
486.79408667805626
560.30511028006867
640.17148596278003
726.56828396517528
819.66595630412007
919.63068739413745
1026.6247020264896
1140.8065376985237
1262.3312868624748
1391.3508135827674
1528.0139482583893
1672.466663417079
1824.852233074979
1985.3113777460389
2153.9823968558162
2331.0012900465108
2516.501868640833
2710.6158583514839
2913.4729941728719
3125.201108266243
3345.9262115439469
3575.7725695694749
3814.8627733141766
4063.3178052469948
4321.257101178142
4588.798608229923
4866.058839266725
5153.1529240803338
5450.1946575956208
5757.2965453343368
6074.569846350927
6402.1246138331662
6740.0697335419745
7088.5129602482966
]';
I_approximate = zeros(length(a1),length(y));
max_d = zeros(1,length(a1));
for j = 1:length(a1)
    for i = 1:length(y)
        I_approximate(j,i) = gamma(k+1)*y(i).*(1+a1(j)*y(i)+y(i)^3/(gamma(k+2))^(3/k))^(k/3);
    end
    delta = log(abs(I_approximate(j,:)./I_precesion));
    
    plot( x, delta, 'k', 'linewidth', 2)
    axis([-10 30 -0.025 0.025]),grid on
    
%     title(['Подгоночный коэффициент: ' sprintf('%f', a1(j))])
    pause(10^-6);
    if (a1(j) > 0.89) 
        break;
    end
   
    max_d(j) = max(abs(delta));
end
hold on
xlabel('x'); ylabel('ln(I_п_р_и_б_л/I_т_о_ч_н)')
plot([-10,0;30,0],[0,-0.015;0,0.015],'k','linewidth',1.4);
disp(max_d');