%% Проверка глобальной аппроксимации из статьи
clc
clear all
close all

format long

k = 7/2; 
x = -10:50;
y = log(1 + exp(x));

a1 = 0.25:0.01:5;
I_precesion = [
    0.00052807859268266507
0.0014354614937241278
0.0039019523288631799
0.010606335964723075
0.028829014882432807
0.078350656715051314
0.21287059771474817
0.57784553750874823
1.5649662632360704
4.2132640719263597
11.183716751693321
28.831318415993749
70.76455639709738
162.5664404398951
346.75806173093724
687.30940653775667
1273.5281924057904
2223.4234340108451
3686.6789666116119
5847.3411013584682
8926.2908960557179
13183.54802600513
18920.438394893674
26481.648335557245
36257.182291946578
48684.236907585422
64249.001700196648
83488.394530782636
106991.73861426771
135402.38670634993
169419.29723502454
209798.56645799789
257354.92017317397
312963.16805659689
377559.62332774594
452143.49012911541
537778.2207430175
635592.84454402269
746783.27039304341
872613.5640130759
1014417.2017425145
1173598.3019361442
1351632.8351735235
1550069.8143370859
1770532.4655360752
2014719.3807756912
2284405.6532023503
2581443.9956945633
2907765.8435137374
3265382.4416794386
3656385.9176885649
4082950.3401570255
4547332.7639253475
5051874.2621356659
5599000.9457566012
6191224.97100408
6831145.5350800818
7521449.86062722
8264914.169275118
9064404.6446337812
9922878.3850705847
    ]';
I_approximate = zeros(length(a1),length(y));

max_d = zeros(1,length(a1));
for j = 1:length(a1)
    for i = 1:length(y) 
        I_approximate(j,i) = gamma(k+1)*y(i).*(1+a1(j)*y(i)+y(i)^3/(gamma(k+2))^(3/k))^(k/3);
    end
    delta = log10(abs(I_approximate(j,:)./I_precesion));
    
    plot(x, delta, 'k', 'linewidth',2)
    axis([-10 20 -0.05 0.05]),grid on
    xlabel('x'); ylabel('lg(d)')
    title(['Подгоночный коэффициент: ' sprintf('%f', a1(j))])
    pause(10^-6);
    if (a1(j) > 0.55) 
        break;
    end
    max_d(j) = max(abs(delta));
end
disp(max_d');