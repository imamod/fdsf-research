%% Проверка глобальной аппроксимации из статьи
clc
clear all
close all

format long

k = -3/2; 
x = -2.4:0.1:50;
y = log(1 + exp(x));

I_precesion = [-0.19729006651545164
-0.21495038336938768
-0.23387271532489343
-0.25408493446671965
-0.2756023484334057
-0.29842495676102643
-0.3225345453817231
-0.34789169615357374
-0.3744328150105577
-0.40206731037392929
-0.43067508087986534
-0.46010449558774646
-0.49017106735410293
-0.52065702727637508
-0.55131200122767388
-0.58185496512239787
-0.61197761129541783
-0.64134919355440767
-0.66962283468554828
-0.69644318178385167
-0.72145518885724003
-0.74431370223846216
-0.76469343345760132
-0.7822988375651464
-0.7968733821648728
-0.80820770022599875
-0.81614617028678016
-0.82059155801873496
-0.8215074753883379
-0.81891855591050366
-0.81290839245402469
-0.80361542312698808
-0.79122706803309051
-0.77597250558343256
-0.75811452634218535
-0.73794091441016374
-0.71575578451939559
-0.69187125380705305
-0.66659975893028245
-0.64024725053663445
-0.61310741626362142
-0.58545700714563875
-0.5575522754645188
-0.52962647766984128
-0.50188835522920283
-0.47452147891939622
-0.4476843268703754
-0.42151096172043412
-0.39611217534232518
-0.37157697855421284
-0.34797432601535899
-0.32535498139799585
-0.30375344354223438
-0.2831898696053658
-0.26367194549353679
-0.24519666666671125
-0.22775200350886804
-0.21131843479087936
-0.19587034037651888
-0.18137725036182917
-0.16780495246785793
-0.15511646291936843
-0.14327286843249334
-0.13223404848791076
-0.12195928795189526
-0.11240779047424014
-0.10353910306685594
-0.095313461956168591
-0.087692069293130309
-0.080637309666154441
-0.07411291464889451
-0.068084082867990586
-0.062517562326537698
-0.057381700989282865
-0.052646470940713445
-0.048283470777120266
-0.044265910294115328
-0.040568580984529465
-0.037167815368391893
-0.03404143773545068
-0.03116870848897102
-0.028530263934180605
-0.026108053052145998
-0.023885272536311227
-0.02184630114064785
-0.019976634191689293
-0.018262818948166323
-0.016692391348265032
-0.015253814562684398
-0.013936419668936306
-0.012730348676224381
-0.011626500058536998
-0.010616476894313666
-0.0096925376624384506
-0.0088475497048350546
-0.0080749453342318697
-0.007368680540549938
-0.006723196229814825
-0.0061333819146152033
-0.0055945417641593258
-0.0051023629142537986
-0.0046528859324825146
-0.0042424773310130257
-0.0038678040183910997
-0.0035258095820537832
-0.0032136922948000878
-0.0029288847408597057
-0.0026690349602843289
-0.0024319890139801069
-0.0022157748756591418
-0.002018587561193158
-0.0018387754102068977
-0.0016748274391717259
-0.0015253616896886652
-0.0013891145000327317
-0.0012649306323273448
-0.0011517541918978547
-0.0010486202793934842
-0.000954647320150422
-0.0008690300189836956
-0.00079103289213440715
-0.00071998433145812181
-0.00065527115911849835
-0.00059633363404889834
-0.00054266087426671256
-0.00049378666177477307
-0.00044928559926699058
-0.00040876959017739021
-0.00037188461577973407
-0.00033830778506608889
-0.00030774463501419134
-0.00027992666060274325
-0.0002546090555581548
-0.00023156864632297222
-0.0002106020031324178
-0.00019152371337797047
-0.00017416480363240786
-0.00015837129781554282
-0.00014400290000017227
-0.00013093179129924082
-0.00011904153114345816
-0.00010822605405876411
-9.8388753790010195e-05
-8.9441647295648085e-05
-8.1304611762385154e-05
-7.3904688362751514e-05
-6.7175447006104528e-05
-6.1056406818310938e-05
-5.5492507530487347e-05
-5.0433627365817936e-05
-4.5834143388449099e-05
-4.1652530622437116e-05
-3.7850996564149052e-05
-3.439514800066056e-05
-3.1253687311675205e-05
-2.8398135675237319e-05
-2.5802580819845197e-05
-2.3443447169138288e-05
-2.1299286411677578e-05
-1.9350586698870401e-05
-1.7579598830116979e-05
-1.5970177926975319e-05
-1.4507639228660677e-05
-1.317862676053299e-05
-1.1970993736314671e-05
-1.0873693654485465e-05
-9.8766811404067863e-06
-8.9708216689650272e-06
-8.1478093785553682e-06
-7.4000922566679968e-06
-6.7208040407473307e-06
-6.1037022358876764e-06
-5.5431117037763753e-06
-5.0338733255309312e-06
-4.5712972850963076e-06
-4.1511205600347851e-06
-3.7694682431863805e-06
-3.4228183521068305e-06
-3.1079698136810812e-06
-2.8220133391179329e-06
-2.5623049298890703e-06
-2.3264417782962633e-06
-2.1122403474292227e-06
-1.9177164344915523e-06
-1.74106703898635e-06
-1.5806538732152965e-06
-1.4349883670914743e-06
-1.3027180325210856e-06
-1.1826140646859962e-06
-1.0735600685616823e-06
-9.7454180902788654e-07
-8.8463789205895147e-07
-8.0301129279606048e-07
-7.2890165387652217e-07
-6.6161828429152395e-07
-6.0053379532343423e-07
-5.4507831583134885e-07
-4.9473423435919966e-07
-4.4903142027974476e-07
-4.0754288050172877e-07
-3.698808121942902e-07
-3.356930155567206e-07
-3.0465963391455161e-07
-2.7649019138316982e-07
-2.5092090103405545e-07
-2.2771221894995091e-07
-2.0664662178565936e-07
-1.8752658748043187e-07
-1.7017276061406993e-07
-1.5442228557841342e-07
-1.4012729226369019e-07
-1.2715352034895852e-07
-1.1537906954995373e-07
-1.0469326432736034e-07
-9.4995622604190273e-08
-8.6194918991879584e-08
-7.8208333889505639e-08
-7.0960680606906399e-08
-6.4383703377542725e-08
-5.8415439777115216e-08
-5.2999641655096307e-08
-4.8085249223791637e-08
-4.3625913438165569e-08
-3.9579562243864505e-08
-3.5908006674673741e-08
-3.257658314770915e-08
-2.9553828638293978e-08
-2.6811185719744307e-08
-2.4322734728929479e-08
-2.2064950568998399e-08
-2.0016481888349318e-08
-1.8157950581838419e-08
-1.6471769748267876e-08
-1.4941978409071305e-08
-1.3554091448394578e-08
-1.2294963375866372e-08
-1.1152664641557903e-08
-1.0116369349119106e-08
-9.1762533189170005e-09
-8.3234015491598733e-09
-7.5497242103516487e-09
-6.8478803877884437e-09
-6.2112088589077977e-09
-5.6336652578015823e-09
-5.1097650387003632e-09
-4.6345317042847388e-09
-4.2034498137718681e-09
-3.8124223303177323e-09
-3.4577319077781973e-09
-3.1360057536590902e-09
-2.8441837384974617e-09
-2.579489452260594e-09
-2.3394039359086793e-09
-2.1216418412950721e-09
-1.9241297953070338e-09
-1.7449867647906604e-09
-1.5825062375473641e-09
-1.4351400517098349e-09
-1.3014837212610426e-09
-1.1802631194938863e-09
-1.0703223949519721e-09
-9.7061300596260338e-10
-8.801837703783431e-10
-7.9817183668200421e-10
-7.2379449126987494e-10
-6.5634172459046253e-10
-5.9516948595417528e-10
-5.3969356330974925e-10
-4.8938403016640494e-10
-4.437602071815587e-10
-4.0238609078231873e-10
-3.6486620559028787e-10
-3.3084184141451684e-10
-2.9998763920416741e-10
-2.7200849364450905e-10
-2.4663674306809545e-10
-2.2362962006534163e-10
-2.0276693864066097e-10
-1.8384899599491062e-10
-1.6669466904309169e-10
-1.5113968761705667e-10
-1.3703506797373197e-10
-1.2424569174568118e-10
-1.1264901684701521e-10
-1.021339080966096e-10
-9.2599576454053884e-11
-8.3954616792407045e-11
-7.6116135065328983e-11
-6.9008956573304363e-11
-6.2564907802429634e-11
-5.6722165006852359e-11
-5.1424663338999558e-11
-4.6621560906175714e-11
-4.2266752653371114e-11
-3.8318429445114341e-11
-3.4738678148383523e-11
-3.1493118908024699e-11
-2.8550576159474694e-11
-2.5882780244199473e-11
-2.3464096784157209e-11
-2.1271281235535515e-11
-1.9283256281482492e-11
-1.7480909940822371e-11
-1.5846912466870735e-11
-1.4365550289307094e-11
-1.3022575414318525e-11
-1.1805068845432823e-11
-1.0701316721006531e-11
-9.7006979854897222e-12
-8.7935825215017793e-12
-7.9712387694639576e-12
-7.2257499519903964e-12
-6.5499381022974335e-12
-5.9372951703303508e-12
-5.3819205478336516e-12
-4.8784644148464791e-12
-4.4220763656708559e-12
-4.0083588227644558e-12
-3.6333247927313552e-12
-3.2933595600569501e-12
-2.9851859518527269e-12
-2.7058328409991146e-12
-2.4526065860260236e-12
-2.2230651341445679e-12
-2.0149945393072251e-12
-1.8263876702701951e-12
-1.6554249045797919e-12
-1.5004566234053449e-12
-1.3599873393737241e-12
-1.2326613051906755e-12
-1.1172494650099919e-12
-1.0126376233683554e-12
-9.1781571816423614e-13
-8.318680947346448e-13
-7.5396468767456372e-13
-6.83353025742307e-13
-6.1935098308263313e-13
-5.6134020715364113e-13
-5.0876016023156051e-13
-4.6110271725142669e-13
-4.1790726807761038e-13
-3.7875627713713679e-13
-3.4327125773699779e-13
-3.1110912236609524e-13
-2.8195887389121023e-13
-2.5553860582885313e-13
-2.3159278284244326e-13
-2.098897753052297e-13
-1.9021962420962651e-13
-1.7239201491637977e-13
-1.5623444024349717e-13
-1.4159053521432888e-13
-1.2831856743400854e-13
-1.1629006855946153e-13
-1.0538859368467916e-13
-9.5508596692965271e-14
-8.6554410743125321e-14
-7.8439324067843994e-14
-7.1084742179413605e-14
-6.4419428409369188e-14
-5.8378815462413632e-14
-5.2904381348507799e-14
-4.7943083676710269e-14
-4.3446846856246231e-14
-3.9372097259721171e-14
-3.5679341865301613e-14
-3.2332786313464839e-14
-2.9299988693616655e-14
-2.655154572011868e-14
-2.4060808269378067e-14
-2.1803623532615139e-14
-1.9758101295470516e-14
-1.7904402088200279e-14
-1.622454516107284e-14
-1.4702234430753567e-14
-1.3322700716778926e-14
-1.2072558744347593e-14
-1.0939677532104389e-14
-9.9130629127326517e-15
-8.9827510512447958e-15
-8.1397119319963848e-15
-7.3757618816664042e-15
-6.6834842826726492e-15
-6.0561577105653709e-15
-5.4876908006260137e-15
-4.9725632138813951e-15
-4.5057721316530748e-15
-4.0827837611635152e-15
-3.6994893831307994e-15
-3.3521655161672095e-15
-3.0374378125776262e-15
-2.752248336214634e-15
-2.4938259057359805e-15
-2.259659216241702e-15
-2.0474724791288412e-15
-1.8552033443497692e-15
-1.6809828913309993e-15
-1.5231174948155348e-15
-1.3800723900266277e-15
-1.2504567779888192e-15
-1.1330103267424977e-15
-1.0265909376941803e-15
-9.3016365858712512e-16
-8.4279063567354395e-16
-7.6362200772802252e-16
-6.9188765365872891e-16
-6.2688971373661615e-16
-5.679958119531222e-16
-5.1463291380596437e-16
-4.6628175996619951e-16
-4.2247182185732923e-16
-3.82776730232526e-16
-3.4681013241819575e-16
-3.1422193804511171e-16
-2.8469491685255365e-16
-2.5794161556259111e-16
-2.337015639138787e-16
-2.1173874274695344e-16
-1.9183928957319608e-16
-1.7380941936184465e-16
-1.5747354036607004e-16
-1.4267254670026863e-16
-1.2926227109472386e-16
-1.171120828072356e-16
-1.0610361707920492e-16
-9.6129623799664232e-17
-8.7092924197186726e-17
-7.8905465427693192e-17
-7.1487463876054628e-17
-6.4766628850248314e-17
-5.8677459127028835e-17
-5.3160605515136469e-17
-4.8162293242882705e-17
-4.3633798557691747e-17
-3.9530974451493261e-17
-3.5813820902834739e-17
-3.2446095458851653e-17
-2.9394960371976429e-17
-2.6630662861282972e-17
-2.4126245390100202e-17
-2.1857283143094631e-17
-1.9801646150255061e-17
-1.7939283744665135e-17
-1.6252029257952961e-17
-1.4723423053956027e-17
-1.3338552179353454e-17
-1.2083905071510266e-17
-1.0947239910133012e-17
-9.9174653319570692e-18
-8.9845323478724829e-18
-8.1393364108054613e-18
-7.3736286813679272e-18
-6.6799356277243303e-18
-6.0514861771708158e-18
-5.482145710365273e-18
-4.9663562556989178e-18
-4.4990823016086386e-18
-4.0757616992788539e-18
-3.692261177703522e-18
-3.3448360379538595e-18
-3.030093634161158e-18
-2.744960285571885e-18
-2.4866512974221287e-18
-2.2526437986344474e-18
-2.0406521317565643e-18
-1.8486055554046291e-18
-1.6746280419850164e-18
-1.5170199738668252e-18
-1.3742415596608769e-18
-1.2448978090092239e-18
-1.1277249194654455e-18
-1.0215779427971934e-18
-9.2541961050285716e-19
-8.3831020962463931e-19
-7.593984101706631e-19
-6.8791295472856593e-19
-6.2315512925234454e-19
-5.6449194161491067e-19
-5.1134994141471474e-19
-4.6320962077325919e-19
-4.1960034152179062e-19
-3.8009573930538209e-19
-3.4430955978066605e-19
-3.118918862949719e-19
-2.8252572225057229e-19
-2.5592389481523484e-19
-2.318262497730223e-19
-2.0999711014772212e-19
-1.9022297380311696e-19
-1.7231042755450246e-19
-1.5608425743716001e-19
-1.4138573669043188e-19
-1.2807107474926057e-19
-1.1601001210542037e-19
-1.0508454732349237e-19
-9.5187783785758702e-20
-8.62228849081861e-20
-7.810212762791001e-20
-7.0746044921424179e-20
-6.408264898137262e-20
-5.8046727466897621e-20
-5.2579205955581363e-20
-4.7626570371088945e-20
-4.3140343745962584e-20
-3.9076612209351124e-20
-3.5395595569935226e-20
-3.2061258299629702e-20
-2.9040957118043362e-20
-2.6305121734999691e-20
-2.382696563215635e-20
-2.158222405806201e-20
-1.95489166767157e-20
-1.770713255043976e-20
-1.6038835355986374e-20
-1.4527686930403683e-20
-1.3158887422211709e-20
-1.1919030485629924e-20
-1.0795972102540119e-20
-9.7787117499925631e-21
-8.857284751669124e-21
-8.0226647609821663e-21
-7.2666754224771493e-21
-6.5819103478874172e-21
-5.9616606244359584e-21
-5.3998491465838723e-21
    ]';

a1 = 1.5:0.01:3;

I_approximate = zeros(length(a1),length(y));

max_d = zeros(1,length(a1));
for j = 1:length(a1)
    for i = 1:length(y)
        I_approximate(j,i) = gamma(k+1)*y(i).*(1 + a1(j)*y(i) + y(i)^3/(gamma(k+2))^(3/k))^(k/3);
    end
    delta = log10(abs(I_approximate(j,:)./I_precesion(1,:)));
%     delta = log(abs(I_approximate(j,:)./I_precesion(1,:)));
%     delta = I_approximate(j,:)./I_precesion(1,:) - 1;
    plot(x, delta, 'k', 'linewidth',2)
    axis([-10 10 -1 5]),grid on
    xlabel('x'); ylabel('lg(d)')
    title(['Подгоночный коэффициент: ' sprintf('%f', a1(j))])
    pause(10^-6);
%     if (a1(j) > 1.617)
%         break;
%     end
    max_d(j) = max(abs(delta));
end
hold on
plot([-2.4,0;30,0],[0,-0.06;0,0.06],'k','linewidth',1.5);
disp(max_d');