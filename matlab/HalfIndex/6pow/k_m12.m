%% Проверка глобальной аппроксимации из статьи
clc
clear all
close all

format long

k = -1/2; 

x = -10:0.1:50;
y = log(1 + exp(x));

I_precesion = [8.046669716113733e-05
8.892915334094758e-05
9.8281547336484461e-05
0.00010861746000929659
0.00012004031094835781
0.00013266439249693025
0.00014661601236936231
0.00016203475624300865
0.0001790748829000199
0.00019790686580671425
0.00021871909646717095
0.00024171976648641895
0.00026713894704232774
0.00029523088641069994
0.00032627654833334359
0.00036058641638411
0.00039850359209482741
0.00044040721747566245
0.0004867162557287543
0.00053789366743834787
0.00059445102335600655
0.00065695359911927941
0.00072602600188271334
0.00080235838394048149
0.00088671330402239072
0.00097993330309479308
0.0010829492682434153
0.0011967896656077197
0.0013225907314305869
0.0014616077191399901
0.0016152273100505259
0.0017849813058236285
0.0019725617323185173
0.0021798374969644032
0.0024088727553493359
0.0026619471574110759
0.0029415781594836388
0.0032505456055443127
0.0035919187993532133
0.0039690863087966915
0.0043857887646303424
0.0048461549379312076
0.0053547414038356243
0.0059165761234342817
0.0065372063008303973
0.007222750898070996
0.007979958216568302
0.0088162689792452963
0.0097398853723253513
0.010759846528612645
0.011886110954227593
0.0131296464167495
0.014502527822935811
0.016018043616608881
0.017690811219453526
0.019536902016353264
0.021573976348900098
0.023821428921545221
0.026300544939425723
0.029034667179253449
0.032049374037882147
0.035372668399367993
0.03903517690156888
0.04307035885763931
0.047514723685322106
0.052408055206152812
0.057793640585675557
0.063718500982775497
0.07023362015050065
0.077394166273507814
0.085259701233267218
0.093894370261433449
0.10336706358206105
0.11375154017279941
0.12512650222582733
0.13757560731046664
0.1511874037018785
0.16605517293964028
0.18227666254011651
0.19995369106081598
0.21919160758617576
0.24009858838049034
0.262784755160056
0.28736110240081641
0.31393822552952588
0.34262484790928027
0.37352615230746311
0.40674193198951486
0.4423645875206742
0.48047700739153221
0.52115038310798356
0.56444202158102719
0.61039322850675737
0.65902734480535408
0.71034802292696642
0.76433782987397081
0.82095725833157052
0.8801442159461117
0.94181404567680871
1.0058601080048157
1.0721549299401798
1.1405518980489644
1.2108874452807181
1.28298365644708
1.3566511968425405
1.4316924543352987
1.5079047782946118
1.5850836992403081
1.6630260206533043
1.7415326878979014
1.820411357146948
1.8994786077993009
1.9785617633437933
2.0575003063339228
2.1361468917810584
2.2143679789276969
2.2920441135086835
2.3690699011044831
2.4453537172016544
2.5208172014917047
2.5953945832884662
2.6690318823131398
2.7416860250688768
2.8133239121362204
2.8839214664228017
2.953462687059301
3.0219387285209045
3.0893470198558766
3.1556904347329477
3.2209765194302022
3.2852167828876992
3.348426050508718
3.4106218814749205
3.4718240478798892
3.5320540729203103
3.5913348246510921
3.6496901613495951
3.7071446242901658
3.763723173655162
3.819450963361096
3.8743531507238154
3.92845473709643
3.9817804358649811
4.0343545644620473
4.0862009573435092
4.1373428971587085
4.1878030616213087
4.2376034838527472
4.2867655242183442
4.3353098519063797
4.3832564347115603
4.4306245356763734
4.477432715417037
4.5236988391162187
4.5694400873031089
4.6146729696642526
4.659413341237209
4.70367642043405
4.7474768084256569
4.7908285094902983
4.8337449519935545
4.8762390097214334
4.9183230233361899
4.9600088217650491
5.0013077433672217
5.0422306567547874
5.0827879811683845
5.1229897063307241
5.1628454117191218
5.202364285214073
5.2415551410937162
5.2804264373550476
5.3189862923518483
5.3572425007465583
5.3952025487796496
5.4328736288648525
5.4702626535225409
5.5073762686667767
5.5442208662637515
5.5808025963814396
5.6171273786512037
5.6532009131633574
5.6890286908189065
5.724616003160123
5.7599679517026097
5.7950894567911417
5.8299852660015361
5.864659962110002
5.8991179706512176
5.9333635670854079
5.9674008835943049
6.001233915524943
6.034866527499644
6.0683024592096766
6.1015453309093841
6.134598648626822
6.1674658091060781
6.2001501044959211
6.2326547267984713
6.2649827720910967
6.2971372445338369
6.3291210601743213
6.36093705056114
6.3925879661763005
6.4240764796967822
6.4554051890945523
6.4865766205839446
6.5175932314248062
6.5484574125894062
6.5791714913004506
6.6097377334474228
6.6401583458876967
6.6704354786389342
6.7005712269684574
6.7305676333852436
6.7604266895398579
6.7901503380371748
6.8197404741665739
6.849198947554
6.8785275637400636
6.907728085687963
6.9368022352250875
6.9657516944215745
6.9945781069091719
7.0232830791435452
7.0518681816127451
7.0803349499947759
7.1086848862667109
7.1369194597678201
7.1650401082190474
7.1930482387009294
7.2209452285920444
7.24873242646997
7.2764111529764373
7.3039827016485512
7.3314483397176318
7.3588093088771647
7.3860668260214863
7.4132220839563265
7.4402762520827759
7.4672304770556996
7.4940858834179158
7.5208435742110638
7.5475046315644825
7.5740701172627105
7.6005410732930025
7.6269185223732663
7.6532034684617232
7.679396897248699
7.7054997766316102
7.7315130571737178
7.7574376725472387
7.7832745399617771
7.8090245605783739
7.8346886199099188
7.8602675882084432
7.8857623208398957
7.9111736586468027
7.9365024282993728
7.9617494426354218
7.9869155009897241
8.012001389512978
8.0370078814809709
8.0619357375942524
8.0867857062686355
8.1115585239169938
8.1362549152224943
8.1608755934037909
8.1854212604724079
8.2098926074824004
8.234290314772954
8.2586150522038455
8.2828674793842154
8.3070482458947446
8.3311579915035985
8.3551973463763733
8.3791669312800003
8.4030673577812021
8.4268992284394137
8.450663136994347
8.4743596685486082
8.4979893997452987
8.5215528989409197
8.5450507263736348
8.5684834343271028
8.5918515672900231
8.6151556621114835
8.6383962481523113
8.6615738474325745
8.6846889747751863
8.7077421379459796
8.7307338377901527
8.7536645683653891
8.7765348170715143
8.7993450647770874
8.8220957859427678
8.8447874487416875
8.8674205151769083
8.8899954411959801
8.9125126768028551
8.9349726661669706
8.9573758477298391
8.9797226543091337
9.002013513200195
9.024248846275281
9.046429070080535
9.0685545959305411
9.0906258300008886
9.1126431734184923
9.1346070223499822
9.1565177680878964
9.1783757971351623
9.2001814912875144
9.22193522771415
9.2436373790365991
9.265288313405831
9.2868883945776837
9.3084379819866339
9.3299374308180028
9.3513870920785802
9.3727873126656487
9.3941384354347548
9.4154407992657685
9.4366947391277698
9.4579005861424132
9.4790586676460205
9.5001693072503972
9.5212328249024623
9.5422495369424212
9.5632197561609065
9.5841437918550056
9.6050219498830494
9.6258545327182059
9.6466418395012532
9.6673841660919653
9.6880818051198361
9.7087350460334108
9.7293441751490271
9.7499094756982192
9.7704312278745142
9.7909097088791182
9.8113451929657796
9.8317379514847918
9.8520882529261158
9.8723963629617675
9.8926625444871945
9.9128870576621768
9.933070159950578
9.9532121061597234
9.9733131484787663
9.9933735365164331
10.013393517338134
10.033373335502246
10.053313233095849
10.073213449769755
10.093074222772891
10.112895786986082
10.132678374955153
10.1524222169236
10.172127540864455
10.191794572511718
10.211423535391225
10.231014650850943
10.250568138090696
10.270084214191408
10.289563094143832
10.309004990876769
10.328410115284852
10.347778676255672
10.367110880696652
10.386406933561403
10.405667037875428
10.42489139476176
10.444080203465763
10.463233661379862
10.482351964067611
10.501435305287458
10.520483877016117
10.539497869471534
10.558477471135491
10.577422868775738
10.59633424746794
10.615211790617121
10.634055679978774
10.652866095679718
10.671643216238463
10.690387218585409
10.709098278082628
10.727776568543341
10.746422262251073
10.765035529978542
10.783616541006211
10.802165463140534
10.820682462732025
10.839167704692901
10.857621352514414
10.876043568284235
10.894434512703089
10.912794345101593
10.931123223456417
10.949421304406643
10.967688743269383
10.985925694055583
11.004132309485366
11.022308741003167
11.04045513879263
11.058571651791423
11.076658427705622
11.094715613023991
11.112743353032062
11.130741791825962
11.148711072326083
11.166651336290432
11.184562724328002
11.202445375911713
11.2202994293913
11.238125022006056
11.25592228989712
11.273691368120016
11.291432390656642
11.309145490427236
11.326830799302172
11.34448844811366
11.362118566666997
11.379721283752023
11.397296727154169
11.414845023665498
11.432366299095413
11.44986067828137
11.46732828509951
11.484769242474782
11.502183672391372
11.519571695902714
11.536933433141465
11.554269003329214
11.571578524786331
11.588862114941325
11.606119890340334
11.623351966656497
11.640558458698944
11.657739480421963
11.674895144933819
11.692025564505643
11.709130850579998
11.726211113779549
11.743266463915457
11.760297009995687
11.777302860233288
11.794284122054469
11.811240902106618
11.828173306266221
11.845081439646666
11.861965406605931
11.878825310754152
11.895661254961208
11.912473341364038
11.929261671374002
11.9460263456841
11.962767464276077
11.979485126427425
11.996179430718405
12.01285047503888
12.029498356594971
12.046123171915932
12.062725016860613
12.079303986624005
12.095860175743702
12.112393678106232
12.128904586953359
12.145392994888237
12.161858993881571
12.178302675277672
12.194724129800408
12.211123447559041
12.227500718054191
12.243856030183512
12.260189472247328
12.276501131954374
12.292791096427212
12.309059452207835
12.325306285263009
12.341531680989615
12.357735724219994
12.373918499227122
12.390080089729823
12.406220578897775
12.422340049356679
12.438438583193117
12.454516261959578
12.470573166679255
12.486609377850854
12.502624975453418
12.518620038950907
12.534594647296965
12.550548878939379
12.566482811824729
12.58239652340281
12.59829009063108
12.614163589979009
12.630017097432482
12.645850688498005
12.661664438206921
12.677458421119738
12.693232711330097
12.708987382468932
12.724722507708552
12.740438159766557
12.756134410909894
12.771811332958624
12.78746899728994
12.803107474841896
12.818726836117236
12.834327151187065
12.849908489694618
12.865470920858915
12.88101451347832
12.896539335934179
12.912045456194255
12.9275329418164
12.943001859951899
12.958452277348822
12.973884260355605
12.989297874924279
13.004693186613757
13.02007026059318
13.035429161645171
13.050769954168979
13.066092702183619
13.081397469331231
13.096684318879834
13.111953313726843
13.12720451640164
13.142437989068938
13.157653793531585
13.172851991233603
13.188032643262996
13.203195810354783
13.218341552893673
13.233469930917051
13.248581004117685
13.263674831846549
13.278751473115488
13.2938109866
13.308853430641895
13.323878863251933
13.338887342112471
13.353878924580075
13.36885366768807
13.383811628149081
13.398752862357583
13.413677426392432
13.428585376019228
13.443476766692861
13.458351653559927
13.473210091461048
13.48805213493335
13.502877838212704
13.517687255236211
13.532480439644305
13.547257444783224
13.562018323707083
13.576763129180298
13.591491913679745
13.606204729396765
13.620901628239691
13.63558266183562
13.650247881532843
13.664897338402797
13.679531083242161
13.69414916657499
13.708751638654713
13.723338549466176
13.737909948727596
13.752465885892658
13.767006410152455
13.781531570437355
13.796041415418996
13.81053599351219
13.825015352876848
13.839479541419877
13.85392860679692
13.868362596414258
13.882781557430743
13.897185536759496
13.911574581069662
13.925948736788291
13.940308050102043
13.95465256695889
13.968982333069956
13.98329739391111
13.997597794724669
14.011883580521246
14.026154796081038
14.040411485955989
14.05465369447092
14.06888146572552
14.083094843595701
14.097293871735346
14.111478593577788
14.12564905233736
14.139805291011076
    ]';

c2 = 5:0.01:6;
I_approximate = zeros(length(c2),length(y));
max_d = zeros(1,length(c2));

c1 = 3*(1-2^(-k))/k;
c3 = (k+1)*pi^2;

for j = 1:length(c2)
    for i = 1:length(y)
        I_approximate(j,i) = (y(i)/(k + 1)).*((gamma(k+2)^(6/k))*(1 + c1 * y(i) + c2(j)*y(i)^2) + c3 * y(i)^4 + y(i)^6)^(k/6);
    end
    delta = log(abs(I_approximate(j,:)./I_precesion));
    
    plot( x, delta, 'k', 'linewidth',2)
    axis([-10 30 -0.015 0.015]),grid on
    xlabel('x'); ylabel('lg(d)')
    title(['Подгоночный коэффициент: ' sprintf('%f', c2(j))])
    pause(10^-6);
    if (c2(j) > 5.79)
        break;
    end
    max_d(j) = max(abs(delta));
end
hold on
plot([-10,0;30,0],[0,-0.01;0,0.01],'k','linewidth',1.5);
disp(max_d');