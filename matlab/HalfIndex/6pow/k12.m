%% Проверка глобальной аппроксимации из статьи
clc
clear all
close all

format long

k = 1/2; 

x = -10:50;
y = log(1 + exp(x));

c2 = 1.5:0.01:3;
I_precesion = [
    4.0233994366893932e-05
0.00010936431957977029
0.00029726075928624785
0.00080787393828178448
0.0021948143568012953
0.0059571769051784754
0.016127737943983776
0.043366367550415563
0.11458782392526307
0.29050089616991759
0.67809389515310103
1.3963752806665639
2.5024578260071397
3.9769853540479772
5.7707265276048965
7.8379760572930968
10.144284932196006
12.664637572252108
15.380486122493426
18.277560250119556
21.344471492355183
24.571846256840303
27.951777387232191
31.477464866725903
35.142970916048796
38.943046600932703
42.873004868750684
46.928624881287519
51.106078178005433
55.401870530650683
59.812795370358032
64.335895938831783
68.968434140868382
73.707864628492061
78.551813027366251
83.498057483993193
88.544512904724627
93.689217398477808
98.930320539789079
104.26607314782143
109.69481833726653
115.2149836436886
120.82507406224673
126.52366586741279
132.30940110411507
138.18098265902449
144.13716983547522
150.1767743675303
156.29865681854744
162.50172331770887
168.78492259470102
175.14724327833139
181.587711429558
188.10538828335615
194.69936817718286
201.36877664663484
208.11276867130641
214.9305270559291
221.82126093364175
228.78420437977894
235.81861512588438
    ]';
I_approximate = zeros(length(c2),length(y));
max_d = zeros(1,length(c2));

c1 = 3*(1-2^(-k))/k;
c3 = (k+1)*pi^2/(gamma(k+2)^(6/k));
c4 = 1/(gamma(k+2))^(6/k);

for j = 1:length(c2)
    for i = 1:length(y)
        I_approximate(j,i) = gamma(k+1)*y(i).*(1+c1*y(i)+c2(j)*y(i)^2+c3*y(i)^4 + c4*y(i)^6)^(k/6);
    end
    delta = log(abs(I_approximate(j,:)./I_precesion));
    
    plot( x, delta, 'k', 'linewidth',2)
    axis([-10 30 -0.008 0.008]),grid on
    xlabel('x'); ylabel('lg(d)')
    title(['Подгоночный коэффициент: ' sprintf('%f', c2(j))])
    pause(10^-6);
    if (c2(j) > 2.42)
        break;
    end
    max_d(j) = max(abs(delta));
end
hold on
plot([-10,0;30,0],[0,-0.008;0,0.008],'k','linewidth',1.5);
disp(max_d');