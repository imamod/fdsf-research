clc
clear all
close all

% Данные для отображения
x = -10:0.5:8;
Ikm32 = [-0.00016092822815933993,-0.0002653147425823757,-0.00043740002472874857,-0.0007210690943895235,-0.0011886201173217066,-0.0019591005148322394,-0.003228373386804613,-0.005318242392255334,-0.00875623841368493,-0.014403914757530743,-0.023659662440401907,-0.03876999336075539,-0.0632824325264963,-0.10263880881376108,-0.16478041077300673,-0.260305826000058,-0.40108449328644835,-0.5955363524643875,-0.8394844152932344,-1.1062615172482342,-1.347436477715508,-1.513216466569946,-1.5800537734471374,-1.559346852811412,-1.4823079543883808,-1.3801910769455357,-1.2744409689563307,-1.1762800285454225,-1.0899547999147212,-1.0159465023784795,-0.953083801509992,-0.899680762789105,-0.8540629925367825,-0.8147683761219371,-0.7805939050216409,-0.7505784586840677,-0.7239645228912456];
Ikm12 = [8.046669716113733e-05,0.00013266439249693033,0.00021871909646717193,0.00036058641638411206,0.0005944510233560106,0.0009799333030948013,0.001615227310050544,0.0026619471574111093,0.004385788764630406,0.007222750898071113,0.011886110954227806,0.019536902016353646,0.032049374037882834,0.05240805520615393,0.08525970123326887,0.1375756073104694,0.21919160758617975,0.34262484790928605,0.5211503831079913,0.764337829873981,1.0721549299401913,1.4316924543353118,1.8204113571469627,2.214367978927711,2.5953945832884786,2.9534626870593135,3.2852167828877126,3.591334824651103,3.8743531507238247,4.137342897158718,4.38325643471157,4.614672969664263,4.833744951993564,5.042230656754794,5.241555141093725,5.432873628864858,5.617127378651217];
Ik0 = [4.539889921686464e-05,7.484902862926716e-05,0.00012340218972325883,0.00020344767212944308,0.00033540637289576885,0.0005529314753607963,0.0009114664537742446,0.001502310159754284,0.00247568513773045,0.0040784432705707205,0.006715348489118069,0.011047744848593817,0.01814992791780974,0.029750418272620566,0.048587351573742055,0.07888973429254963,0.1269280110429725,0.20141327798275244,0.3132616875182228,0.47407698418010663,0.6931471805599452,0.9740769841801067,1.3132616875182228,1.7014132779827524,2.1269280110429727,2.5788897342925496,3.048587351573742,3.5297504182726205,4.0181499279178094,4.511047744848594,5.006715348489118,5.504078443270571,6.00247568513773,6.501502310159754,7.000911466453775,7.500552931475361,8.000335406372896];
Ik12 = [4.023399436689393e-05,6.63339516214174e-05,0.00010936431957977027,0.00018030617692548338,0.00029726075928624785,0.0004900624417920692,0.0008078739382817844,0.0013316806469218351,0.002194814356801295,0.0036165853780679475,0.005957176905178476,0.009806656183236765,0.016127737943983776,0.026480621921677674,0.043366367550415556,0.07072432464891104,0.11458782392526308,0.18380185763787188,0.29050089616991753,0.44979304683642474,0.6780938951531008,0.9902092487127998,1.396375280666564,1.9008334610643878,2.5024578260071406,3.196598699384758,3.9769853540479763,4.837065897622567,5.7707265276048965,6.772573881760251,7.837976057293097,8.962995226676554,10.144284932196006,11.378986438535819,12.664637572252106,13.999097433575992,15.380486122493428];
Ik1 = [4.5399414484476326e-05,7.485042923518698e-05,0.00012340599680056542,0.0002034580201021805,0.00033543449830263463,0.0005530079133607274,0.000911674167582222,0.0015028744878921297,0.002477217813442276,0.004082603579881552,0.0067266308775223976,0.011078295470850085,0.018232448969983026,0.02997242154966197,0.04918072033882423,0.08045926924846478,0.13101248471442378,0.21178197962544582,0.3386479964034522,0.5332172799948812,0.8224670334241131,1.236716786853345,1.806286070444774,2.5581520872227808,3.5139215821338023,4.689474797599762,6.095753346509403,7.739961645298565,9.626701617878243,11.758855771377375,14.138207435970703,16.765851463268344,19.642456849034783,22.768431192360335,26.144022392680643,29.769381058934865,33.644598632349926];
Ik32 = [6.0351475898064254e-05,9.95022439975999e-05,0.00016405005803954577,0.0002704689926564117,0.00044591757785330605,0.0007351655197879866,0.001212006184440951,0.0019980515607041856,0.0032936628101454617,0.005428791299959435,0.008946382260412247,0.014738753193550986,0.024269405334868585,0.03993062669545474,0.06561173880637544,0.10758087439445906,0.1758009888540129,0.28577205975996417,0.46084880629010166,0.7346593353498717,1.1528038370883613,1.7727936118421093,2.661682624732003,3.891975540893775,5.537253675008344,7.668804264252523,10.353714864761452,13.654201686109145,17.627702501044965,22.327331714909572,27.802446215748386,34.09919512328479,41.26100263922604,49.32897218341864,58.342217041669215,68.33812856132882,79.35259363033187];
Ik2 = [9.079934424349552e-05,0.00014970225910735594,0.00024681580081764007,0.0004069263888008981,0.0006708971248073442,0.0011060922772451953,0.0018235561050747736,0.0030063135551674056,0.004955969427212798,0.008169372499034183,0.013464566610971755,0.02218724170474075,0.0365478637632424,0.060168810499834614,0.09896340290959225,0.16252511789564714,0.2662654587713006,0.4345668272969057,0.7051297585956156,1.1343684889845556,1.8030853547393912,2.820969222499449,4.328331225625401,6.494369027841585,9.512668392830873,13.595528785470112,18.96856780399895,25.866373945104087,34.52935373188239,45.20159384333878,58.1294719017599,73.56077744116286,91.74416477160594,112.92881584924878,137.3642338253136,165.30011709500064,196.9862826333631];
Ik52 = [0.0001508792951864644,0.00024875725573064245,0.0004101296185697767,0.000676184641324737,0.001114826995969972,0.0018380036328608982,0.0030302596112063854,0.004995792380760558,0.008235959698417906,0.01357687461989505,0.022379248358526813,0.0368829403842442,0.06077118937450074,0.1000905778411199,0.16474039373220511,0.27085618652993665,0.444554453458763,0.7276460926129003,1.1859681754434674,1.920737873606388,3.082586082837418,4.88671401524457,7.626535355005596,11.683159162928304,17.52941918738426,25.728967291974033,36.93206541329326,51.86981146923186,71.34805232382338,96.24167336393687,127.48954491322317,166.09017428484194,213.09800591862415,269.6202759321161,336.8143249237027,415.8852838077065,508.0840620214693];
Ik3 = [0.0002723988056492321,0.00044910887830860384,0.000740453113416892,0.0012207946899213395,0.0020127335695206503,0.0033183915200471975,0.005470980026208348,0.00901978778594169,0.0148702101076284,0.02451437054246367,0.04041067963210762,0.06660780175010918,0.10976848735585347,0.18084436528246428,0.29780187847092043,0.49002320119001785,0.8053194930232082,1.3208804023057312,2.159839661017986,3.515198851950534,5.682196976983475,9.098520652152585,14.389356493493644,22.412443502886745,34.29828326312246,51.482509506181174,75.72981188039815,109.1505015453568,154.21146067532595,213.7431557132466,290.9440382879518,389.383271149901,513.0024029634677,666.1163921391936,853.41423080063,1079.9593243430852,1351.1897220552569];
Ik72 = [0.000528078592682665,0.0008706532751311415,0.0014354614937241283,0.002366667524781328,0.0039019523288631795,0.006433169937468157,0.010606335964723077,0.017486434702309293,0.028829014882432807,0.0475276354571712,0.0783506567150513,0.12915350442992643,0.21287059771474814,0.3507812694308199,0.5778455375087481,0.9513715904792343,1.5649662632360704,2.5706650596304796,4.213264071926359,6.88185701616552,11.183716751693318,18.044040502277962,28.83131841599376,45.503253644413554,70.76455639709741,108.22728467592508,162.56644043989508,239.6666058159899,346.75806173093713,492.5425182403639,687.3094065377567,943.0439477830729,1273.5281924057902,1694.4360841573982,2223.423434010846,2880.213529254126,3686.678966611612];
Ik4 = [0.0010895967684436615,0.0017964397152489054,0.002961823875781128,0.004883209807554476,0.008051018672007478,0.013273795473515539,0.021884543601642346,0.03608084571991821,0.059485445584039065,0.0980699949823525,0.1616767081951023,0.2665234946124579,0.43932434057265235,0.7240559910123789,1.1930426236172633,1.9650400959911738,3.234547351955163,5.318826533483004,8.732138288905944,14.30020167023245,23.330874490725822,37.85770661159046,60.96945037216665,97.23055015973574,153.187589122834,237.9486088136748,363.81864929082906,546.9755138110204,808.1727487171897,1173.460332032196,1674.9165892116473,2351.38710846975,3249.2279740976583,4423.051646081637,5936.474454970443,7862.865080220865,10286.093626450782];

% Сводный рисунок
hold on

% Значения Ik(x)/Г(k+1)
I_all = [Ikm32; Ikm12; Ik0; Ik12; Ik1; Ik32; Ik2; Ik52; Ik3; Ik72; Ik4];
k_all = [-3/2 -1/2 0 1/2 1 3/2 2 5/2 3 7/2 4];

for i = 1:size(I_all,1)
    I_normalized = I_all(i, :)./gamma(k_all(i) + 1);
    plot(x, log10(I_normalized), 'k');
end

xleft = -3; xright = 6; ylower = -1.5; yupper = 2.25;
axis([xleft xright ylower yupper]); % для lg
%  axis([-3 6 -3 5]); % для ln
% Настройка осей
xlabel('x', 'Position', [xright + 0.25 ylower]);
ylabel('lg(I_k(x)/Г(k+1))', 'Rotation',0,'Position', [xleft yupper]);
line([0, xleft; 0, xright], [ylower, 0; yupper, 0],'color', 'black');

text(6.05, -0.55, '-3/2');
text(6.05, 0.45, '-1/2');
text(6.05, 0.8, '0');
text(6.05, 1.05, '1/2');
text(6.05, 1.3, '1');
text(6.05, 1.5, '3/2');
text(6.05, 1.65, '2');
text(6.05, 1.82, '5/2');
text(6.05, 1.95, '3');
text(6.05, 2.05, '7/2');
text(6.05, 2.2, '4');

% Прорежаем разметку осей
xA = get(gca, 'XTickLabel');
for i = 1:size(xA,1)
    z = rem(i, 2);
    if z == 0;
        if xA(i,1)~='0' && xA(i,2)~=0
            xA(i)=char(0);
        end
    end
end

xA(size(xA,1),:)=char(0);
set(gca, 'XTickLabel', xA);

