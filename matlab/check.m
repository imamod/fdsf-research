clc
clear all
close all
format long

%Погрешность различных квадратур

N = [32 64 128 256 512 1024 2048 4096 8192 16384 32768]; 
n = 1:length(N);
% R = [-5.54053
%     -9.18906024154856145935043956893830924012637501718324175730927961553088452200000000
%     -14.43556026249983987340340418486930766669455079729803527542235915903216359300000000
%     -22.96616214144663391739072808653073541930175323246142283180842488745957607600000000
%     -34.59990473077972506219729941456493237153789921117204052873421250533914087900000000
%     -50.17164516806995606368524395789721774796626031238903576996226820814634385400000000
%     -72.66875561074737943009917933368491698412445810872199431262773301799420162600000000
%     ];
lg_R = [-2.40622
-3.99075815678110259286026405803307029275095218797269074027264190156985950900000000
-6.26928416518553791067382782463714217825588734514448714421358304868132206700000000
-9.97407748852564239474403996425894168351295617355223573828494447508638667900000000
-15.02654769895585260584139722780761267498961312320367991182791623868920246400000000
-21.78926864450072953469410492893968657928732880103356094326220756748695660600000000
-31.55963956852355749024579845278884041997642182531160379549548694793245321300000000
-45.87925502174027241565043205668960164509232081716918399075167269038096206800000000
-54.19266392963479206845853996298974172045079984196745432117853187132431456000000000
-54.81944586435035964880848999975753389325743438045717065277951543492128093200000000
-54.84242184784537770324281701991143658102899560378605760330794968800157619600000000
    ];

% figure, grid on, hold on
% plot(log2(N),lg_R,'k-o','MarkerSize', 7, 'linewidth', 2);
% xlabel('log_2 N_m'); ylabel('lg |R_m|');

R = [0.00392444
    0.00010215081670804998161915036613394702051392646151596189737056147370561500000000
    0.00000053791769998073950560708476555214272626979069384329641313386413133933333333
    0.00000000010615061422098775310652994381687051354949059006265046652650466666666666
    0.00000000000000094070250615531300861520613728401144324164803717848037178500000000
    0.00000000000000000000016245435398996828794090297199338135979276269792762766666666
    0.00000000000000000000000000000002756515453022232415875890067490380674903800000000
    0.00000000000000000000000000000000000000000000013205199849147371991473719900000000
    0.00000000000000000000000000000000000000000000000000000064170595621705956266666666
    0.00000000000000000000000000000000000000000000000000000015154937011549370100000000
    0.00000000000000000000000000000000000000000000000000000014374016933740169333333333
    ];

N = [16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536 ...
    131072 262144 524288 1048576 2097152 4194304 8388608 16777216 33554432];
n = [16 32 64 128 256 512 1024];
R = [0.00588667
    0.00015322622506209
    0.00000080687654980
    0.00000000015922597
    0.00000000000000178
    0.00000000000000133
    0.00000000000000178
    0.00000000000000133
    0.00000000000000089
    0.00000000000000067
    0.00000000000000222
    0.00000000000000089
    0.00000000000000666
    0.00000000000002265
    0.00000000000003597
    0.00000000000001621
    0.00000000000009370
    0.00000000000003730
    0.00000000000022005
    0.00000000000010880
    0.00000000000100431
    0.00000000000141887
    ];

R_ = [0.00588667
    0.00015322622506209
    0.00000080687654980
    0.00000000015922597
    0.00000000000000178
    0.00000000000000133
    0.00000000000000178];
figure, grid on, hold on
plot(log2(N),log10(R),'k-o','MarkerSize', 7, 'linewidth', 2);
xlabel('log_2 N_m'); ylabel('lg |R_m|');

figure, grid on, hold on
plot(n,log10(R_),'k-o','MarkerSize', 7, 'linewidth', 2);

xlabel('N_m'); ylabel('lg |R_m|');
axis([0 log2(N(end))+0.1 -16.3 0]);
% legend('M = 1','M = 3', 'M = 5');